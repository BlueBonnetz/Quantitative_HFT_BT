# Quantitative_HFT_BT
# Reverse Order Flow Imbalance (OFI) + Mean Reversion Trading Strategy

## р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Вр╕Фр╕вр╕вр╣Ир╕н

р╕Щр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕Ър╕Ъ Backtesting р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣Мр╕Бр╕▓р╕гр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Бр╕Щр╕зр╕Чр╕▓р╕З Mean Reversion р╕Ьр╕кр╕бр╕Бр╕▒р╕Ъ Reverse Order Flow Imbalance (OFI) р╣Вр╕Фр╕вр╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Чр╕│р╕Бр╕▓р╕гр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓ (Futures Market) р╕Ир╕▓р╕Бр╕Хр╕ер╕▓р╕Ф TFEX р╣Ар╕Юр╕╖р╣Ир╕нр╕Юр╕┤р╕Ир╕▓р╕гр╕Ур╕▓р╕кр╕▒р╕Нр╕Нр╕▓р╕Ур╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕Хр╕▓р╕бр╕Юр╕др╕Хр╕┤р╕Бр╕гр╕гр╕бр╕Вр╕нр╕Зр╕Хр╕ер╕▓р╕Ф

**р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:** р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Щр╕╡р╣Й **р╣Др╕бр╣Ир╣Гр╕Кр╣Ир╕гр╕░р╕Ър╕Ър╕кр╣Ир╕Зр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕Ир╕гр╕┤р╕З** р╣Бр╕Хр╣Ир╣Ар╕Ыр╣Зр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕ер╕░р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Вр╕нр╕Зр╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣Мр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ

---

## р╕лр╕ер╕▒р╕Бр╕Бр╕▓р╕гр╕Вр╕нр╕Зр╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣М

### 1я╕ПтГг Reverse Order Flow Imbalance (Reverse OFI)
- р╕Ыр╕Бр╕Хр╕┤ OFI р╣Гр╕Кр╣Йр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Бр╕гр╕Зр╕Лр╕╖р╣Йр╕н/р╕Вр╕▓р╕вр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╕Вр╕нр╕Зр╕Ыр╕гр╕┤р╕бр╕▓р╕У Bid р╣Бр╕ер╕░ Ask
- р╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣Мр╕Щр╕╡р╣Йр╣Гр╕Кр╣Й **Reverse OFI** р╕Лр╕╢р╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щр╕Бр╕▓р╕гр╕кр╕зр╕Щр╕Чр╕▓р╕Зр╕Бр╕▒р╕Ър╕кр╕▒р╕Нр╕Нр╕▓р╕Ур╕Ыр╕Бр╕Хр╕┤
- р╕лр╕▓р╕Бр╕Хр╕ер╕▓р╕Фр╕бр╕╡р╣Бр╕гр╕Зр╕Лр╕╖р╣Йр╕нр╣Ар╕Вр╣Йр╕▓ (OFI > р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Ф) тЖТ **р╣Ар╕Ыр╕┤р╕Фр╕кр╕Цр╕▓р╕Щр╕░ Short**
- р╕лр╕▓р╕Бр╕Хр╕ер╕▓р╕Фр╕бр╕╡р╣Бр╕гр╕Зр╕Вр╕▓р╕вр╣Ар╕Вр╣Йр╕▓ (OFI < р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Ф) тЖТ **р╣Ар╕Ыр╕┤р╕Фр╕кр╕Цр╕▓р╕Щр╕░ Long**

### 2я╕ПтГг Mean Reversion Strategy
- р╕кр╕бр╕бр╕Хр╕┤р╕зр╣Ир╕▓р╕гр╕▓р╕Др╕▓р╕бр╕╡р╣Бр╕Щр╕зр╣Вр╕Щр╣Йр╕бр╕Ир╕░р╕Бр╕ер╕▒р╕Ър╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕Др╣Ир╕▓р╣Ар╕Йр╕ер╕╡р╣Ир╕в (Mean) р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Бр╕┤р╕Фр╕Др╕зр╕▓р╕бр╕Ьр╕▒р╕Щр╕Ьр╕зр╕Щр╕кр╕╣р╕З
- р╣Гр╕Кр╣Йр╕Др╣Ир╕▓ **Quantile (р╣Ар╕Ыр╕нр╕гр╣Мр╣Ар╕Лр╣Зр╕Щр╣Др╕Чр╕ер╣М) р╕Вр╕нр╕З OFI** р╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕│р╕лр╕Щр╕Фр╕Вр╕нр╕Ър╣Ар╕Вр╕Хр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╣Ар╕Чр╕гр╕Ф
- р╕Бр╕│р╕лр╕Щр╕Фр╣Гр╕лр╣Й **Quantile 80% р╣Ар╕Ыр╣Зр╕Щр╕Ир╕╕р╕Фр╣Ар╕Вр╣Йр╕▓ Short** р╣Бр╕ер╕░ **Quantile 30% р╣Ар╕Ыр╣Зр╕Щр╕Ир╕╕р╕Фр╣Ар╕Вр╣Йр╕▓ Long**

### 3я╕ПтГг Execution р╕Ьр╣Ир╕▓р╕Щ Market Depth (VWAP Matching)
- р╣Гр╕Кр╣Й **Volume-Weighted Average Price (VWAP)** р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕│р╕Щр╕зр╕Ур╕гр╕▓р╕Др╕▓р╕Лр╕╖р╣Йр╕н-р╕Вр╕▓р╕вр╕Чр╕╡р╣Ир╣Бр╕Чр╣Йр╕Ир╕гр╕┤р╕З
- р╕Ир╕│р╕ер╕нр╕Зр╕Бр╕▓р╕гр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╣Вр╕Фр╕вр╕Др╕│р╕Щр╕зр╕Ур╕Ир╕▓р╕Б **Bid/Ask Depth** р╕Вр╕нр╕Зр╕Хр╕ер╕▓р╕Ф
- р╣Гр╕Кр╣Йр╕Вр╕Щр╕▓р╕Фр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М **30% р╕Вр╕нр╕З Volume р╕Чр╕╡р╣Ир╕гр╕░р╕Фр╕▒р╕Ър╕гр╕▓р╕Др╕▓р╕Чр╕╡р╣И 1 (vBid1 р╕лр╕гр╕╖р╕н vAsk1)** р╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Ф Market Impact р╣Бр╕ер╕░ Slippage
- р╣Гр╕Кр╣Й **р╕Др╣Ир╕▓р╕Шр╕гр╕гр╕бр╣Ар╕Щр╕╡р╕вр╕бр╕Ир╕гр╕┤р╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ър╕ер╕╣р╕Бр╕Др╣Йр╕▓р╕Чр╕▒р╣Ир╕зр╣Др╕Ыр╣Гр╕Щр╕Хр╕ер╕▓р╕Ф TFEX (0.00007)** р╕лр╕▒р╕Бр╕Ир╕▓р╕Бр╕Бр╕│р╣Др╕гр╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕│р╕Щр╕зр╕У Net Profit

### 4я╕ПтГг р╕Бр╕▓р╕гр╕Ыр╕┤р╕Фр╕кр╕Цр╕▓р╕Щр╕░
- р╣Ар╕бр╕╖р╣Ир╕нр╣Др╕Фр╣Йр╕гр╕▒р╕Ъ **р╕кр╕▒р╕Нр╕Нр╕▓р╕Ур╕Хр╕гр╕Зр╕Вр╣Йр╕▓р╕б** тЖТ **р╕Ыр╕┤р╕Фр╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕Фр╕┤р╕бр╕Бр╣Ир╕нр╕Щ р╣Бр╕ер╣Йр╕зр╣Ар╕Ыр╕┤р╕Фр╕кр╕Цр╕▓р╕Щр╕░р╣Гр╕лр╕бр╣И**
- р╕лр╕▓р╕Бр╕Цр╕╢р╕З **р╕кр╕┤р╣Йр╕Щр╕зр╕▒р╕Щр╣Бр╕ер╕░р╕вр╕▒р╕Зр╕бр╕╡р╕кр╕Цр╕▓р╕Щр╕░р╕Др╣Йр╕▓р╕Зр╕нр╕вр╕╣р╣И** тЖТ **р╕Ыр╕┤р╕Фр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф** р╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ Overnight Risk

---

## р╕Бр╕▓р╕гр╕зр╕▒р╕Фр╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣М (Performance Metrics)
| Metrics | р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф |
|---------|------------|
| **Final PnL** | р╕Бр╕│р╣Др╕г/р╕Вр╕▓р╕Фр╕Чр╕╕р╕Щр╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕вр╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Ыр╕┤р╕Фр╕кр╕Цр╕▓р╕Щр╕░р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф |
| **ROI (%)** | р╕Ьр╕ер╕Хр╕нр╕Ър╣Бр╕Чр╕Щр╕Ир╕▓р╕Бр╣Ар╕Зр╕┤р╕Щр╕Чр╕╕р╕Щр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ |
| **Maximum Drawdown (MDD)** | р╕Вр╕▓р╕Фр╕Чр╕╕р╕Щр╕кр╕╣р╕Зр╕кр╕╕р╕Фр╕Чр╕╡р╣Ир╣Ар╕Бр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Ар╕Чр╕гр╕Ф |
| **Sharpe Ratio** | р╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Вр╕нр╕Зр╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣Мр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╕Ьр╕ер╕Хр╕нр╕Ър╣Бр╕Чр╕Щр╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З |
| **Profit Factor** | р╕нр╕▒р╕Хр╕гр╕▓р╕кр╣Ир╕зр╕Щр╕Вр╕нр╕Зр╕Бр╕│р╣Др╕гр╕гр╕зр╕бр╣Ар╕Чр╕╡р╕вр╕Ър╕Бр╕▒р╕Ър╕Вр╕▓р╕Фр╕Чр╕╕р╕Щр╕гр╕зр╕б |
| **Win Rate** | р╕нр╕▒р╕Хр╕гр╕▓р╕Др╕зр╕▓р╕бр╕кр╕│р╣Ар╕гр╣Зр╕Ир╕Вр╕нр╕Зр╣Ар╕Чр╕гр╕Фр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф |
| **Total Trades** | р╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф |
| **Slippage Cost** | р╕Хр╣Йр╕Щр╕Чр╕╕р╕Щр╕Чр╕╡р╣Ир╣Ар╕Бр╕┤р╕Фр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕ер╕╖р╣Ир╕Щр╣Др╕лр╕ер╕Вр╕нр╕Зр╕гр╕▓р╕Др╕▓ |
| **Fee Cost** | р╕Др╣Ир╕▓р╕Шр╕гр╕гр╕бр╣Ар╕Щр╕╡р╕вр╕бр╕Бр╕▓р╕гр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф |

---

## р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╕░р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### ЁЯУМ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Dependencies
```bash
pip install -r requirements.txt
```

### ЁЯУМ р╕Бр╕▓р╕гр╕гр╕▒р╕Щ Backtest
```bash
python backtest.py
```

---

## р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Ир╕▓р╕Б Backtest
- р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М **Performance_Report.csv** р╕Чр╕╡р╣Ир╕бр╕╡р╕кр╕Цр╕┤р╕Хр╕┤р╕Вр╕нр╕Зр╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣М
- р╣Др╕Яр╕ер╣М Log р╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕Ир╕░р╕Цр╕╣р╕Бр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М **Trade_Logs/**
- р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Шр╕╕р╕гр╕Бр╕гр╕гр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Ир╕░р╕Цр╕╣р╕Бр╣Ар╕Бр╣Зр╕Ър╣Гр╕Щ **Transaction_Pairs/**

